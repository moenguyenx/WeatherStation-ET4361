/*======================================================================================================================
 *                                                  INCLUDE FILES
 * 1) system and project includes
 * 2) needed interfaces from external units
 * 3) internal and external interfaces from this unit
======================================================================================================================*/
#include <Arduino.h>
/*======================================================================================================================
 *                                                  CONSTANTS
======================================================================================================================*/
/*======================================================================================================================
 *                                              DEFINES AND MACROS
======================================================================================================================*/
/*======================================================================================================================
 *                                                      ENUMS
======================================================================================================================*/
/*======================================================================================================================
 *                                              STRUCTURES AND OTHER TYPEDEFS
======================================================================================================================*/

/*======================================================================================================================
 *                                              GLOBAL VARIABLE DECLARATIONS
======================================================================================================================*/

/*======================================================================================================================
 *                                                  FUNCTION PROTOTYPES
======================================================================================================================*/

class ZPH01Sensor 
{
  public:
    // Constructor
    ZPH01Sensor(int rxPin, int txPin, long baudRate);

    // Initialize UART communication with the sensor
    void begin();

    // Read PM2.5 concentration in Âµg/m3
    float readPM25();

  private:
    HardwareSerial* serialPort;
    int _rxPin, _txPin;
    long _baudRate;
    uint8_t data[9]; // Buffer to hold sensor data

    // Parse duty cycle from sensor data
    float parseDutyCycle();

    // Calculate PM2.5 concentration based on duty cycle
    float calculatePM25(float dutyCycle);
};